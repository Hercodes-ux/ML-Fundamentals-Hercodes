# Hercodes-ux: Adversarial Machine Learning Lab
# Goal: Use SVM (Support Vector Machines) for high-precision malware detection.
# Technique: Implementing L1 (Lasso) Regularization for automated feature selection 
# to identify the most critical 'attack signatures' in the dataset.


import pandas as pd
from sklearn.svm import SVC
from sklearn.linear_model import LogisticRegression
from sklearn.preprocessing import StandardScaler

# 1. DATA: System Calls, Network Requests, File Permissions
data = {
    'SysCalls': [10, 50, 100, 5, 80, 2, 90, 120, 1],
    'NetRequests': [2, 15, 30, 1, 20, 0, 25, 40, 0],
    'IsMalware': [0, 1, 1, 0, 1, 0, 1, 1, 0]
}
df = pd.DataFrame(data)

# 2. LASSO LOGIC: Deleting useless features
# We use 'L1' penalty to act as a feature selector
selector = LogisticRegression(penalty='l1', solver='liblinear', C=0.1)
selector.fit(df[['SysCalls', 'NetRequests']], df['IsMalware'])

# 3. SVM LOGIC: Finding the widest road
scaler = StandardScaler()
X_scaled = scaler.fit_transform(df[['SysCalls', 'NetRequests']])

# Linear Kernel means a straight road, RBF means a curved road
model = SVC(kernel='linear', probability=True) 
model.fit(X_scaled, df['IsMalware'])

print("--- üõ°Ô∏è Cyber-AI Security Engine ---")
print(f"SVM Support Vectors identified: {len(model.support_)}")
print("Malware detection logic established.")